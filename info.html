<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Información Técnica - ERP Propietario</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f7f6;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .change-record {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }

        .label {
            font-weight: bold;
            color: #2980b9;
        }

        .date {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        ul {
            padding-left: 20px;
        }
    </style>
</head>

<body>
    <h1>Registro de Cambios e Infraestructura ERP</h1>

    <!-- Registro v0.7.1 -->
    <div class="change-record" style="border-left-color: #e74c3c;">
        <h2><span class="label">Versión:</span> 0.7.1 (Validación Domicana de Entidades & Branding Sidebar)</h2>
        <p><span class="label">Fecha:</span>
            <?= date('Y-m-d') ?>
        </p>
        <p><span class="label">Tipo:</span> Estabilidad / UI / Core</p>
        <p><span class="label">Descripción:</span> Refuerzo total de validaciones backend y frontend para RNC, Cédula y
            Nombres, previniendo datos basura en clientes y proveedores. Además, consolidación definitiva del logo en el
            menú lateral y corrección de comportamientos del menú hamburguesa.</p>
        <p><span class="label">Impacto:</span> Clientes, Proveedores, Layout Principal</p>
        <ul>
            <li><strong>Validación Estricta de RNC/Cédula:</strong> Se impide guardar letras o caracteres raros.
                Validadores automáticos y máscaras imponen el formato de 9 dígitos para RNC (000-00000-0) o 11 dígitos
                para Cédula (000-0000000-0). Se exige la exactitud dominicana.</li>
            <li><strong>Sanitización de Nombres:</strong> Prohibidos nombres sin sentido (solo digitos, "me", "yo"...) y
                forzados a usar solo letras, acentos y un mínimo de 3 caracteres de longitud válida. Se incluyó tanto
                por JS (Frontend) como interceptor directo en PHP (Backend).</li>
            <li><strong>Límites Controlados:</strong> Campos como teléfonos no permiten longitudes exageradas.</li>
            <li><strong>UI Responsiva - Sidebar Collapse:</strong> El menú lateral ahora se achica para maximizar
                espacio de trabajo, mostrando solo iconos; los botones <i>toggle</i> controlan eficientemente la
                apertura.</li>
            <li><strong>Branding Constante:</strong> Asignación segura de url `/uploads/logo/system_branding_logo.png`
                (físicamente validada o delegada a URL externa fija) para evitar la pérdida del logo entre secciones y
                conflictos con el `company_logo` del usuario.</li>
        </ul>
        <p><span class="label">Próximos Pasos Pendientes:</span></p>
        <ul>
            <li><strong>Moneda Predeterminada & Dashboard:</strong> Definir en configuración una moneda base para todo
                el sistema (Cotizaciones, Facturas, Compras) y ajustar el Dashboard para priorizar dicha moneda, dejando
                las secundarias (ej. DOP) como informativas abajo.</li>
            <li><strong>Sistema de Respaldo Fiable (Backups):</strong> Implementación de copias de seguridad de la base
                de datos con encriptación nativa para seguridad de la data. Programación semanal automática manteniendo
                un ciclo de máximo 4 archivos (el más antiguo se elimina al entrar el quinto).</li>
            <li><strong>Fase A:</strong> Impacto automático en almacén al marcar una Orden de Compra como Pagada y
                sistema de conversión a Cuentas por Pagar.</li>
            <li><strong>Fase B:</strong> Dashboard de Compras (gastos métricos), ABM enriquecido de Proveedores y
                re-evaluación automática del costo promedio de productos.</li>
            <li><strong>Integración Fiscal:</strong> Reportes 606, 607, y cálculos de la DGII.</li>
        </ul>
    </div>

    <!-- Registro v0.7.0 -->
    <div class="change-record" style="border-left-color: #f1c40f;">
        <h2><span class="label">Versión:</span> 0.7.0 (Sidebar, PO Avanzados e Inventario Inteligente)</h2>
        <p><span class="label">Fecha:</span> 2026-02-27</p>
        <p><span class="label">Tipo:</span> UX / Proveedores / Almacén</p>
        <p><span class="label">Descripción:</span> Reestructuración de la UI a un menú lateral (Sidebar Acordeón),
            gestión profunda de inventario propio vs. terceros, e implementación completa de
            Órdenes de Compra con estados y formatos de impresión.</p>
        <p><span class="label">Impacto:</span> UX Global, Almacén y Compras</p>
        <ul>
            <li><strong>Sidebar Acordeón:</strong> Migración de la navegación superior a un menú lateral
                responsivo con categorías colapsables, optimizado para móviles y de detección automática.</li>
            <li><strong>Inventario Inteligente:</strong> Adición de banderas `is_own_stock` y `low_stock_threshold`
                para diferenciar mercancía propia de terceros. El dashboard inteligente ahora solo alerta sobre
                ítems propios debajo de su propio límite personalizado.</li>
            <li><strong>Órdenes de Compra (PO):</strong> Implementación de estados lógicos (DRAFT, SENT, PAID,
                CANCELLED)
                con vistas modulares nativas. Rediseño de impresión A4 limpia.</li>
            <li><strong>Flujo Seguro CSRF:</strong> Validaciones de estados para evitar anular compras previamente
                marcadas como pagadas (recibidas).</li>
        </ul>
        <p><span class="label">Próximos Pasos Planificados:</span></p>
        <ul>
            <li><strong>Fase A:</strong> Impacto automático en almacén al marcar una Orden como Pagada y sistema de
                conversión a Cuentas por Pagar.</li>
            <li><strong>Fase B:</strong> Dashboard de Compras (gastos métricos), ABM enriquecido de Proveedores y
                re-evaluación automática del costo promedio de productos.</li>
        </ul>
    </div>

    <!-- Registro v0.6.0 -->
    <div class="change-record" style="border-left-color: #9b59b6;">
        <h2><span class="label">Versión:</span> 0.6.0 (NCF, Retenciones y Top Navbar)</h2>
        <p><span class="label">Fecha:</span> 2026-02-27</p>
        <p><span class="label">Tipo:</span> UX / Contabilidad / Core</p>
        <p><span class="label">Descripción:</span> Implementación de Números de Comprobantes Fiscales (NCF), retenciones
            manuales y reorganización de la navegación principal.</p>
        <p><span class="label">Impacto:</span> Facturación, UI Principal y Base de Datos</p>
        <ul>
            <li><strong>Generación Dinámica de NCF:</strong> Generación automática de B01 para empresas con RNC y de B02
                para consumidores con Cédula o sin identificación tributaria al convertir cotizaciones en facturas.</li>
            <li><strong>Retenciones Manuales:</strong> Opción para aplicar un porcentaje de retención definido
                manualmente por el usuario al generar la factura. El monto retenido se calcula sobre el total y se
                refleja en los formatos de impresión.</li>
            <li><strong>Rediseño de Navegación:</strong> Sustitución de la antigua barra lateral (Sidebar) por una nueva
                barra de navegación superior (Top Navbar) categorizada mediante menús desplegables (Dropdowns) para una
                interfaz más limpia.</li>
            <li><strong>Migraciones DB:</strong> Adición de campos `ncf`, `retention_percentage`, y `retention_amount` a
                la tabla de `documents`.</li>
        </ul>
        <p><span class="label">Próximos Pasos:</span></p>
        <ul>
            <li>Integrar Reportes 606, 607, y cálculos de la DGII.</li>
            <li>Terminar los módulos pendientes bajo las nuevas categorías (Contabilidad, Informes).</li>
        </ul>
    </div>

    <!-- Registro v0.5.0 -->
    <div class="change-record" style="border-left-color: #2ecc71;">
        <h2><span class="label">Versión:</span> 0.5.0 (Identidad Corporativa y Ciclo de Vida)</h2>
        <p><span class="label">Fecha:</span> 2026-02-26</p>
        <p><span class="label">Tipo:</span> UX / Identidad / Control</p>
        <p><span class="label">Descripción:</span> Implementación de carga de logo corporativo, rediseño de documentos
            para impresión profesional (A4) y gestión completa del estado de facturas con permisos de reversión.</p>
        <p><span class="label">Impacto:</span> Facturación, Configuración y Core</p>
        <ul>
            <li><strong>Logo Corporativo:</strong> Opción en Configuración para subir el logo de la empresa, persistente
                en todas las vistas de detalle e impresión.</li>
            <li><strong>Formato A4 Profesional:</strong> Rediseño de `show.php` y `print.php` para Facturas y
                Cotizaciones, ahora visualmente idénticos a un documento PDF profesional con optimización de color para
                impresoras.</li>
            <li><strong>Ciclo de Vida de Factura:</strong> Flujo DRAFT (Borrador) → SENT (Enviada) → PAID (Pagada).</li>
            <li><strong>Seguridad de Pagos:</strong> Solo usuarios SUPER_ADMIN pueden revertir el estado de una factura
                pagada para corrección de errores humanos.</li>
            <li><strong>Estado en Español:</strong> Etiquetas de estado localizadas (PAGADA, ENVIADA, ANULADA) con
                indicadores visuales de color.</li>
        </ul>
        <p><span class="label">Próximos Pasos:</span></p>
        <ul>
            <li>Implementar órdenes de compra (Purchase Orders) con formato <strong>PO26-00001</strong>.</li>
            <li>Seguimiento de saldos pendientes por cliente.</li>
        </ul>
    </div>

    <!-- Registro v0.4.0 -->
    <div class="change-record" style="border-left-color: #f39c12;">
        <h2><span class="label">Versión:</span> 0.4.0 (Facturación Avanzada y Multi-Moneda)</h2>
        <p><span class="label">Fecha:</span> 2026-02-25</p>
        <p><span class="label">Tipo:</span> Funcional / Finanzas</p>
        <p><span class="label">Descripción:</span> Refinamiento del módulo de facturación con soporte para múltiples
            monedas, descuentos porcentuales por línea, exención de impuestos por ítem y opciones de impresión.</p>
        <p><span class="label">Impacto:</span> Módulo de Facturación y Configuración</p>
        <ul>
            <li>Soporte Multi-Moneda: Configuración de múltiples monedas (DOP, USD, EUR) y selección dinámica al crear
                documentos.</li>
            <li>Descuentos porcentuales por ítem con cálculo automático.</li>
            <li>Control de exención de ITBIS por producto y por línea de factura.</li>
            <li>Inclusión de cuentas bancarias en la configuración, visibles en el pie de página de facturas y
                cotizaciones.</li>
            <li>Botón de impresión optimizado (oculta UI y formatea para papel).</li>
            <li>Búsqueda dinámica de productos (AJAX) en la creación de cotizaciones con autocompletado de SKU y precio.
            </li>
        </ul>
        <p><span class="label">Próximos Pasos (Apuntes del Usuario):</span></p>
        <ul>
            <li>Trabajar en el cálculo de los ítems a facturar.</li>
            <li>Diseñar y ajustar el formato visual de la factura.</li>
            <li>Agregar el logo de la empresa para el formato de dicha factura.</li>
            <li>Enfoque global en todo lo relacionado a cotizar y facturar (gestionar el estado de la factura, revertir
                cambios, etc.).</li>
        </ul>
    </div>

    <!-- Registro v0.3.0 -->
    <div class="change-record" style="border-left-color: #8e44ad;">
        <h2><span class="label">Versión:</span> 0.3.0 (Dashboard + CRM Completo)</h2>
        <p><span class="label">Fecha:</span> 2026-02-25</p>
        <p><span class="label">Tipo:</span> Funcional / UX</p>
        <p><span class="label">Descripción:</span> Rediseño del Dashboard usando la Skill "Dashboard Design Architect"
            con patrón Z y Chart.js. CRM completado con vista de perfil de cliente/proveedor y historial de documentos.
        </p>
        <p><span class="label">Impacto:</span> Dashboard + CRM</p>
        <ul>
            <li>KPIs financieros: Ventas del mes (con delta vs anterior), Cotizaciones pendientes, Facturas emitidas,
                Cuentas por cobrar.</li>
            <li>Gráfico de tendencia 6 meses (Chart.js Line) + Top 5 Clientes (Horizontal Bar).</li>
            <li>Panel de alertas de stock bajo.</li>
            <li>Perfil de Cliente con KPIs (total facturado/cotizado) + historial de documentos.</li>
            <li>Perfil de Proveedor con datos de contacto.</li>
        </ul>
    </div>

    <!-- Registro v0.2.0 -->
    <div class="change-record" style="border-left-color: #e74c3c;">
        <h2><span class="label">Versión:</span> 0.2.0 (Módulos Operativos)</h2>
        <p><span class="label">Fecha:</span> 2026-02-25</p>
        <p><span class="label">Tipo:</span> Funcional / Módulos</p>
        <p><span class="label">Descripción:</span> Implementación de módulos CRM, Inventario y Facturación con CRUD
            completo, formulario dinámico de cotizaciones, cálculo ITBIS 18%, y conversión COT → FAC.</p>
        <p><span class="label">Impacto:</span> Global (Módulos + UI)</p>
        <ul>
            <li>CRUD Clientes y Proveedores con búsqueda por nombre/RNC.</li>
            <li>CRUD Productos con badge servicio/producto y control de stock visual.</li>
            <li>Formulario de Cotizaciones con líneas dinámicas (JS), auto-llenado de precios.</li>
            <li>Flujo completo: Crear COT (DRAFT) → Aprobar → Convertir a FAC.</li>
            <li>Listado y detalle de Facturas con trazabilidad al documento origen.</li>
            <li>Menú lateral actualizado con todos los módulos.</li>
        </ul>
        <p><span class="label">Pendiente Futuro:</span></p>
        <ul>
            <li>Generación de PDFs para facturas fiscales.</li>
            <li>Reportes gráficos en Dashboard.</li>
            <li>Módulo Contabilidad (premium).</li>
        </ul>
    </div>

    <!-- Registro v0.1.0 -->
    <div class="change-record" style="border-left-color: #27ae60;">
        <h2><span class="label">Versión:</span> 0.1.0 (Arquitectura Base)</h2>
        <p><span class="label">Fecha:</span> 2026-02-25</p>
        <p><span class="label">Tipo:</span> Estructural / Core</p>
        <p><span class="label">Descripción:</span> Implementación completa del Framework MVC modular (Router,
            Controller, Model, View, DB Singleton, Session, Auth). Inclusión del modelo SQL base con 14 tablas
            (incluyendo audit_log).
        </p>
        <p><span class="label">Impacto:</span> Global (Core del sistema)</p>
        <ul>
            <li>Estructura de carpetas modular lista.</li>
            <li>Sistema de roles (SUPER_ADMIN, ADMIN, USER) funcional.</li>
            <li>Instalador web automático para hosting compartido.</li>
            <li>Lógica de conversión de Cotización a Factura implementada en módulo Facturación.</li>
            <li>Diseño premium implementado con CSS moderno.</li>
        </ul>
        <p><span class="label">Pendiente Futuro:</span>
        <ul>
            <li>Desarrollo de interfaces de CRUD para Productos y Clientes.</li>
            <li>Generación de PDFs para facturas fiscales.</li>
            <li>Integración de reportes gráficos en Dashboard.</li>
        </ul>
        </p>
    </div>

    <!-- Registro Inicial -->

</body>

</html>